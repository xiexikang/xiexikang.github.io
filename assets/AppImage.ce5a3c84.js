import{u as e,_ as a}from"./AppIcon.32925989.js";import{f as t,m as i,g as o,r,o as s,c as d,w as n,b as l,h,k as u,B as g,L as m,i as p,d as c,C as y,D as f,M as w,s as b,E as _,G as $}from"./entry-chunk-index-2d707ceb-2023-12-08__17_41_38.js";import{_ as k,r as S,b as E}from"./u-icon.09170e02.js";import{_ as L}from"./u-transition.39d552e8.js";const C=k({name:"u-image",mixins:[i,o,{props:{src:{type:String,default:t.image.src},mode:{type:String,default:t.image.mode},width:{type:[String,Number],default:t.image.width},height:{type:[String,Number],default:t.image.height},shape:{type:String,default:t.image.shape},radius:{type:[String,Number],default:t.image.radius},lazyLoad:{type:Boolean,default:t.image.lazyLoad},showMenuByLongpress:{type:Boolean,default:t.image.showMenuByLongpress},loadingIcon:{type:String,default:t.image.loadingIcon},errorIcon:{type:String,default:t.image.errorIcon},showLoading:{type:Boolean,default:t.image.showLoading},showError:{type:Boolean,default:t.image.showError},fade:{type:Boolean,default:t.image.fade},webp:{type:Boolean,default:t.image.webp},duration:{type:[String,Number],default:t.image.duration},bgColor:{type:String,default:t.image.bgColor}}}],data(){return{isError:!1,loading:!0,opacity:1,durationTime:this.duration,backgroundStyle:{},show:!1}},watch:{src:{immediate:!0,handler(e){e?(this.isError=!1,this.loading=!0):this.isError=!0}}},computed:{wrapStyle(){let e={};return e.width=this.$u.addUnit(this.width),e.height=this.$u.addUnit(this.height),e.borderRadius="circle"==this.shape?"10000px":uni.$u.addUnit(this.radius),e.overflow=this.radius>0?"hidden":"visible",uni.$u.deepMerge(e,uni.$u.addStyle(this.customStyle))}},mounted(){this.show=!0},emits:["click","error","load"],methods:{onClick(){this.$emit("click")},onErrorHandler(e){this.loading=!1,this.isError=!0,this.$emit("error",e)},onLoadHandler(e){this.loading=!1,this.isError=!1,this.$emit("load",e),this.removeBgColor()},removeBgColor(){this.backgroundStyle={backgroundColor:"transparent"}}}},[["render",function(e,a,t,i,o,c){const y=m,f=S(r("u-icon"),E),w=p,b=S(r("u-transition"),L);return s(),d(b,{mode:"fade",show:o.show,duration:e.fade?1e3:0},{default:n((()=>[l(w,{class:"u-image",onClick:c.onClick,style:h([c.wrapStyle,o.backgroundStyle])},{default:n((()=>[o.isError?u("v-if",!0):(s(),d(y,{key:0,src:e.src,mode:e.mode,onError:c.onErrorHandler,onLoad:c.onLoadHandler,"show-menu-by-longpress":e.showMenuByLongpress,"lazy-load":e.lazyLoad,class:"u-image__image",style:h({borderRadius:"circle"==e.shape?"10000px":e.$u.addUnit(e.radius),width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},null,8,["src","mode","onError","onLoad","show-menu-by-longpress","lazy-load","style"])),e.showLoading&&o.loading?(s(),d(w,{key:1,class:"u-image__loading",style:h({borderRadius:"circle"==e.shape?"50%":e.$u.addUnit(e.radius),backgroundColor:this.bgColor,width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},{default:n((()=>[g(e.$slots,"loading",{},(()=>[l(f,{name:e.loadingIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):u("v-if",!0),e.showError&&o.isError&&!o.loading?(s(),d(w,{key:2,class:"u-image__error",style:h({borderRadius:"circle"==e.shape?"50%":e.$u.addUnit(e.radius),width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)})},{default:n((()=>[g(e.$slots,"error",{},(()=>[l(f,{name:e.errorIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):u("v-if",!0)])),_:3},8,["onClick","style"])])),_:3},8,["show","duration"])}],["__scopeId","data-v-2273edd7"]]),B=k(c({__name:"AppImage",props:{imageProps:{type:Object,default:()=>({})},styles:{type:Object,default:()=>({width:"100%",height:"100%"})}},setup(t){const i=t,o=y(),h=f((()=>e.deepAssign({width:"200",height:"200",mode:"aspectFit",shape:"square",alt:"图片",bgColor:"#f3f4f6",src:""},o,i.imageProps))),u=()=>!0;return(e,i)=>{const o=a,m=p,c=S(r("up-image"),C);return s(),d(c,_({class:"AppImage-root"},$(h),{style:t.styles,onError:u}),w({error:n((()=>[l(m,{class:"image-error"},{default:n((()=>[l(o,{iconProps:{name:"photo-fill"},size:30})])),_:1})])),_:2},[b(Object.keys(e.$slots),(a=>({name:a,fn:n((()=>[g(e.$slots,a,{},void 0,!0)]))})))]),1040,["style"])}}}),[["__scopeId","data-v-1456091c"]]);export{B as _};
